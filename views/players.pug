extends layout.pug

block scripts
	script.
		$(function() {
			$('#addPlayerButton').click(function() {
				var player = { name: $('#playerNameInput').val() };
				$.ajax({
					url: '/player/',
					type: 'POST',
					data: JSON.stringify(player),
					contentType: 'application/json',
					success: function(response) {
						location.href = '/player/list';
					},
					error: function(error) {
						// TODO Error handling
						console.log("Unable to add player: " + error);
					}
				});
			});
		});

block content
	h2 Players
	p.
		This is an overview of all players who are participating in Cake Darts

	div(class='table-responsive')
		table(class='table table-striped table-bordered')
			thead
				tr
					th Name
					th Played
					th Won
					th Win %
					th PPD
			tbody
				each player in players
					tr
						th(hidden='true' scope='row')= player._id
						td= player.name
						td= player.gamesPlayed
						td= player.gamesWon
						td= player.gamesPlayed > 0 ? (player.gamesWon / player.gamesPlayed * 100).toFixed(2) : 0
						td= player.ppd

		button(type='button' class='btn btn-block btn-primary' data-toggle='modal' data-target='#addPlayerModal') Add Player
		div(class='modal fade' id='addPlayerModal' tabindex='-1' role='dialog' aria-labelledby='addPlayerModalLabel')
			div(class='modal-dialog' role='document')
				div(class='modal-content')
					div(class='modal-header')
						button(type='button' class='close' data-dismiss='modal' aria-label='Close')
							span(aria-hidden='true') &times;
						h4(class='modal-title' id='addPlayerModalLabel') Add Player
					div(class='modal-body')
						form
							div(class='form-group')
								label(for='player-name' class='control-label') Player Name:
								input(type='text' class='form-control' id='playerNameInput')
						div(class='modal-footer')
							button(type='button' class='btn btn-default' data-dismiss='modal') Close
							button(type='button' class='btn btn-primary' id='addPlayerButton') Add Player
