extends layout.pug

block content
	h2 Results

	p.
		ID: #{match.id} <br>
		Started: #{match.created_at} <br>
		Finished: #{match.end_time === undefined ? '' : match.end_time} <br>
		Duration: #{((Date.parse(match.end_time)/1000 - Date.parse(match.created_at)/1000) / (60)).toFixed()} minutes <br>
		Stakes: #{match.stake === "" ? "None" : match.stake}
	
	table(class='table table-striped table-bordered')
		thead
			tr
				th Player
				th Visits
				th First 9 PPD
				th PPD
				th Scores
				th Winner
		tbody
			each player in players
				tr
					td
						p= player.name
					td
						p= player.visits
					td
						p= player.first9ppd.toFixed(2)
					td
						p= player.ppd.toFixed(2)
					td
						p= player.highScores['60+'] == 0 ? "" : "60+: " + player.highScores['60+']
						p= player.highScores['100+'] == 0 ? "" : "100+ " + player.highScores['100+']
						p= player.highScores['140+'] == 0 ? "" : "140+ " + player.highScores['140+']
						p= player.highScores['180'] == 0 ? "" : "180  " + player.highScores['180']

					if match.winner_id !== undefined && player.id === match.winner_id
						td
							span(class='glyphicon glyphicon-ok' aria-hidden='true')
					else
						td
	p.
		Starting score was #{match.starting_score}, and a total of #{scores.length * 3} darts were thrown by #{Object.keys(players).length} players

	table(class='table table-striped table-bordered')
		thead
			tr
				th Player
				th First Dart
				th Second Dart
				th Third Dart
				th Total
				th PPD
		tbody
			each throws in scores
				tr
					td= players[throws.player_id].name
					td= throws.first_dart * throws.first_dart_multiplier
					td= throws.second_dart * throws.second_dart_multiplier 
					td= throws.third_dart * throws.third_dart_multiplier
					td= (throws.first_dart * throws.first_dart_multiplier) + (throws.second_dart * throws.second_dart_multiplier) + (throws.third_dart * throws.third_dart_multiplier)
					td= (((throws.first_dart * throws.first_dart_multiplier) + (throws.second_dart * throws.second_dart_multiplier) + (throws.third_dart * throws.third_dart_multiplier)) / 3).toFixed(2)

